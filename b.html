<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pygame סוף סוף עובד</title>
    
    <!-- קישור לספריות של PyScript -->
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>

    <!-- הגדרות שאומרות ל-PyScript להוריד את pygame -->
    <py-config>
        packages = ["pygame-ce"]
    </py-config>
</head>

<body>
    <h1>אם אתה רואה חלון אפור עם כדור קופץ - ניצחנו</h1>
    
    <!-- זהו האלמנט שבו המשחק יצויר -->
    <div id="pygame-area" style="border: 2px solid black; width: 480px; height: 320px;"></div>
    
    <!-- כל קוד הפייתון נמצא כאן בפנים -->
    <py-script output="pygame-area">
import pygame
import asyncio

async def main():
    pygame.init()
    screen = pygame.display.set_mode((480, 320))
    clock = pygame.time.Clock()

    x = 240
    y = 160
    vx = 150
    vy = 200

    running = True
    while running:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                running = False
        
        # חישוב התנועה
        dt = clock.tick(60) / 1000.0  # מחשב את הזמן שעבר
        x += vx * dt
        y += vy * dt

        # בדיקת גבולות
        if x < 10 or x > 470:
            vx = -vx
        if y < 10 or y > 310:
            vy = -vy

        # ציור
        screen.fill((200, 200, 200)) # רקע אפור
        pygame.draw.circle(screen, (255, 0, 0), (int(x), int(y)), 10) # עיגול אדום
        pygame.display.flip()

        await asyncio.sleep(0) # מאפשר לדפדפן לעבוד

# מריצים את הפונקציה הראשית
asyncio.run(main())
    </py-script>

</body>
</html>
